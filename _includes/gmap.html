{% if page.map %}
	{% if !page.map.id  %}{% assign page.map.id = 'map' %}{% endif %}
	<section>
		<div id="{{ page.map.id }}" style="width: 100%; height: {{ page.map.height }};"></div>
		<script type='text/javascript' src='http://maps.google.com/maps/api/js?sensor=false&libraries=geometry&v=3.7'></script>
		<script type="text/javascript">
			google.maps.event.addDomListener(window, "load", function() {
				var centerXY = {{ page.map.center | jsonify }};
				var geocoder = new google.maps.Geocoder(); 
				if (typeof geocoder != "undefined") {
					geocoder = new google.maps.Geocoder();
					geocoder.geocode(
						{ "address":"{{ page.map.address }}" },
						function(results,status) {
							if (status == google.maps.GeocoderStatus.OK) {
								var map = new google.maps.Map(
									document.getElementById('{{ page.map.id }}'),
									{
										center: results[0].geometry.location,
										zoom: {{ page.map.zoom }},
										mapTypeControl: false,
									}
								);
								var marker = new google.maps.Marker({
									"map": map,
									"position": results[0].geometry.location,
									"title": "{{ page.map.marker.title }}"{% if page.map.marker.icon %},
									"icon": "{{ page.map.marker.icon | asset_url }}"{% endif %}
								});
							}
						}
					);
				}
			});
		</script>
	</section>
{% endif %}